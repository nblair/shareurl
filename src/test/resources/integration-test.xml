<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
                        http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
                        http://www.springframework.org/schema/tx 
                        http://www.springframework.org/schema/tx/spring-tx-2.5.xsd">
    
    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="/integration-test.properties"/>
        <property name="ignoreUnresolvablePlaceholders" value="true"/>
        <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE"/>
    </bean>
    
    <bean id="accountUsername" class="java.lang.String">
    	<constructor-arg value="${accountUsername}"/>
    </bean>
    <bean id="timespan" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
   		<property name="staticMethod" value="edu.wisc.wisccal.calendarkey.integration.Timespan.createTimespan"/>
   		<property name="arguments">
   			<list>
   				<value>${timespan.startdate}</value>
   				<value>${timespan.enddate}</value>
   			</list>
   		</property>
 	</bean>
 	<bean id="ldapTemplate" class="org.springframework.ldap.core.LdapTemplate">
		<constructor-arg ref="contextSource" />
	</bean>
	<bean id="contextSource" class="org.springframework.ldap.core.support.LdapContextSource">
		<property name="url" value="${ldap.url}"/>
		<property name="userDn" value="${ldap.userDn}"/>
		<property name="password" value="${ldap.password}"/>
		<property name="pooled"><value>false</value></property>
	</bean>
	<bean id="calendarAccountDao" class="edu.wisc.wisccal.calendarkey.impl.oracle.OracleLdapCalendarUserAccountDaoImpl">
    	<property name="ldapTemplate" ref="ldapTemplate"/>
        <property name="baseDn" value="${ldap.accountBaseDn}"/>
    </bean>
     <bean name="calendarDataDao" class="edu.wisc.wisccal.calendarkey.impl.oracle.OracleCalendarDataDaoImpl">
        <property name="serverNodes" ref="oracleCalendarNodeMap"/>
    </bean>
    
    <bean id="node10" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node10000.host}" />
		<property name="sysopPassword" value="${oracle.node10000.sysopPassword}" />
		<property name="nodeName">
			<value>10000</value>
		</property>
	</bean>
	<bean id="node11" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node11000.host}" />
		<property name="sysopPassword" value="${oracle.node11000.sysopPassword}" />
		<property name="nodeName">
			<value>11000</value>
		</property>
	</bean>
	<bean id="node12" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node12000.host}" />
		<property name="sysopPassword" value="${oracle.node12000.sysopPassword}" />
		<property name="nodeName">
			<value>12000</value>
		</property>
	</bean>
	<bean id="node13" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node13000.host}" />
		<property name="sysopPassword" value="${oracle.node13000.sysopPassword}" />
		<property name="nodeName">
			<value>13000</value>
		</property>
	</bean>
	<bean id="node14" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node14000.host}" />
		<property name="sysopPassword" value="${oracle.node14000.sysopPassword}" />
		<property name="nodeName">
			<value>14000</value>
		</property>
	</bean>
	<bean id="node15" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node15000.host}" />
		<property name="sysopPassword" value="${oracle.node15000.sysopPassword}" />
		<property name="nodeName">
			<value>15000</value>
		</property>
	</bean>
	<bean id="node20" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node20000.host}" />
		<property name="sysopPassword" value="${oracle.node20000.sysopPassword}" />
		<property name="nodeName">
			<value>20000</value>
		</property>
	</bean>
	<bean id="node21" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node21000.host}" />
		<property name="sysopPassword" value="${oracle.node21000.sysopPassword}" />
		<property name="nodeName">
			<value>21000</value>
		</property>
	</bean>
	<bean id="node22" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node22000.host}" />
		<property name="sysopPassword" value="${oracle.node22000.sysopPassword}" />
		<property name="nodeName">
			<value>22000</value>
		</property>
	</bean>
	<bean id="node23" class="org.jasig.schedassist.oraclecalendar.OracleCalendarServerNode">
		<property name="serverAddress" value="${oracle.node23000.host}" />
		<property name="sysopPassword" value="${oracle.node23000.sysopPassword}" />
		<property name="nodeName">
			<value>23000</value>
		</property>
	</bean>
	<bean id="oracleCalendarNodeMap" class="org.springframework.beans.factory.config.MapFactoryBean">
		<property name="sourceMap">
			<map>
				<!-- add references to the methods you wish to call -->
				<entry>
					<key><value>10000</value></key>
					<ref bean="node10"/>
				</entry>
				<entry>
					<key><value>11000</value></key>
					<ref bean="node11"/>
				</entry>
				<entry>
					<key><value>12000</value></key>
					<ref bean="node12"/>
				</entry>
				<entry>
					<key><value>13000</value></key>
					<ref bean="node13"/>
				</entry>
				<entry>
					<key><value>14000</value></key>
					<ref bean="node14"/>
				</entry>
				<entry>
					<key><value>15000</value></key>
					<ref bean="node15"/>
				</entry>
				<entry>
					<key><value>20000</value></key>
					<ref bean="node20"/>
				</entry>
				<entry>
					<key><value>21000</value></key>
					<ref bean="node21"/>
				</entry>
				<entry>
					<key><value>22000</value></key>
					<ref bean="node22"/>
				</entry>
				<entry>
					<key><value>23000</value></key>
					<ref bean="node23"/>
				</entry>
			</map>
		</property>
	</bean>
</beans>